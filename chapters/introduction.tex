
\فصل{مقدمه}
 سیستم‌عامل اندروید به دلیل سهولت در توسعه توسط توسعه‌دهندگان موبایلی و در نتیجه فراوانی استفاده از آن در تلفن‌های همراه، تلوزیون‌های هوشمند و دیگر دستگاه‌های موجود، حجم بالایی از بازار سیستم‌عامل‌های موبایلی را به خود اختصاص داده‌است. بر طبق گزارش پایگاه استاتیستا \مرجع{statistaGlobalMobile} سیستم‌عامل اندروید سهمی معادل ۷۱ درصدی از سیستم‌عامل‌های موبایلی را در سه‌ ماهه‌ی پایانی سال ۲۰۲۲ به خود اختصاص داده‌است. در سال‌های اخیر به دلیل گسترش استفاده از این پلتفرم، فروشگاه‌های اندرویدی زیادی به جهت ارائه‌ی خدمات به کاربران به وجود آمده‌است. برخی‌ از فروشگاه‌های رسمی مانند فروشگاه اندرویدی گوگل، از ابزار‌هایی نظیر پلی پروتکت\مرجع{googlePlayProtect} برای بررسی برنامک‌های اندرویدی موجود در فروشگاّه‌ استفاده می‌کنند. علاوه بر این، در سال‌های اخیر فروشگآه‌های متعدد رایگانه به وجود آمده‌اند که صرفا برنامک‌های اندرویدی موجود در سطح وب را غربان و آن را به کاربران ارائه‌ می‌دهند. فروشگاه‌های رایگان غالباً ابزار‌های مشخصی را برای حفظ امنیت کاربران استفاده نمی‌کنند و امنیت کاربران این دسته از فروشگاه‌های اندرویدی،  ، همواره تهدید می‌شود یکی از راه‌های مورد استفاده توسط مهاجمان برای وارد ساختن بدافزار به تلفن‌های همراه، بازبسته‌بندی نرم‌افزار است. مطابق تعریف، بازبسته‌بندی شامل دانلود یک برنامک، دسترسی به محتوای کد‌های برنامک اصلی از طریق روش‌های مهندسی معکوس و در نهایت بازبسته‌بندی به همراه تغییر و یا بدون تغییر‌دادن کد‌های برنامک‌ اصلی است. زبان اصلی توسعه در برنامک‌های اندرویدی، زبان جاوا می‌باشد که یک زبان سطح بالا محسوب می‌شود. در طی فرآیند کامپایل برنامک‌های اندرویدی، مجموعه‌ی کد‌های منبع در طی فرایندی به بایت‌کد‌های دالویک تبدیل می‌شوند و در ادامه ماشین مجازی جاوا، بایت‌کد‌ها را برروی ماشین مقصد اجرا می‌کند\مرجع{cylabDecompileModify}. فهم و در نتیجه مهندسی معکوس زبان میانی دالویک بایت‌کد‌ها آسان است و به همین علت موجب سهولت در بازبسته‌بندی برنامک‌های اندرویدی می‌شود.\\
 به طور کلی بازبسته‌بندی را می‌توان از دو جهت مورد بررسی قرار داد، از دید توسعه‌دهندگان، بازبسته‌بندی شامل فرآیندی است که توسعه‌دهنده با انجام مبهم‌نگاری در برنامک مورد توسعه، فهم بدنه‌ی اصلی برنامک را برای مهاجم سخت می‌کند. از این دید، بازبسته‌بندی یک روش تدافعی تلقی می‌شود تا مهاجم پس از دسترسی به کد برنامک اصلی، نتواند بدنه‌ی برنامک اصلی برنامک را شناسایی و در نتیجه آن‌را تغییر دهد. از حهت دیگر، بازبسته‌بندی توسط فردی که برنامک متعلق به او نیست یک عمل تهاجمی محسوب می‌شود. در این حالت، مهاجم پس از دسترسی به کد برنامک‌اصلی، بسته به هدف او، برنامک‌ را مجددا بازبسته‌بندی می‌کند و آن را در فروشگاه‌های اندرویدی خصوصا فروشگاه‌هایی که نظارت کمتری بر روی آن‌ها وجود دارد منتشر می‌کند. در این حالت مهاجم به جهت اهدافی متفاوتی نظیر تغییر کد‌های تبلیغاتی در برنامک اصلی، تغییر درگاه‌های پرداخت و یا بازپخش بدافزار، اقدام به بازبسته‌بندی می‌کند.
 بازبسته‌بندی یکی از راه‌های محبوب مهاجمان برای انتقال بدافزار‌های توسعه‌داده‌شده به تلفن‌ همراه قربانی‌ است\مرجع{brightsecOWASPMobile}. مطابق پژوهش آقای ژو و همکاران\مرجع{wu2012} حدود۸۵ درصد بدافزار‌های موجود، از طریق بازبسته‌بندی منتشر می‌شوند. همانطور که گفته شد، برخی فروشگآ‌های اندرویدی نظیر گوگل، سازوکار مشخصی را برای تشخیص بازبسته‌بندی ارائه‌داده‌اند اما بسیاری از فروشکاه‌های اندرویدی فعال و پربازدید، خصوصا فروشگاه‌های رایگان، یا از هیچ ابزاری استفاده نمی‌کنند و یا در صورت توسعه‌ی نرم‌افزار بومی خود برای شناسایی برنامک‌های بازبسته‌بندی شده، مشخصات و یا دقت آن را گزارش نکرده‌اند.\\
 همانطور که اشاره‌شد، محبوبیت و در نهایت استفاده‌ی زباد برنامک‌های اندرویدی و همچنین نظارت کم در فروشگاه‌های اندرویدی، بازبسته‌بندی، یک روش پر استفاده به جهت انتقال بدافزار‌ به تلفن همراه کاربران است. آقای خانمحمدی و همکاران\مرجع{Khanmohammadi2019}، پس از بررسی پایگاه‌داده‌ای برنامک‌های اندرویدی اندروزو، دریافتند که  
 $52.22\%$
 از برنامک‌های موجود در این مخزن توسط ویروس‌توتال، بدافزار شناسایی شده‌اند. ویروس‌توتال، ابزاری متشکل از ۳۰ ضد‌بدافزار برای بررسی یک برنامک اندرویدی اندرویدی است. مطابق این پژوهش، 
 $77.84\%$
 از برنامک‌های این مخزن‌داده که بازبسته‌بندی شده‌اند، دارای نوعی از بدافزار ضدتبلیغاتی بوده‌اند که موجب می‌شود تبلیغات موجود در برنامک تغیر و اهداف مالی و امنیتی کاربران و توسعه‌دهندگان مخدوش شود . علاوه بر این، مطابق پژوهشی که توسط ویداس وهمکاران\مرجع{Vidas2013} انجام شده‌است، پس از پیاده‌سازی ۷ روش پربازدید به جهت تشخیص بازبسته‌بندی، در بهترین حالت‌، روش‌های موجود قادر به تشخیص 
 $72.22\%$
 از برنامک‌های بازبسته‌بندی شده‌ی سه فروشگاه مطرح اندرویدی است. بنابراین مشخص است که تشخیص برنامک‌های بازبسته‌بندی شده، به چه میزان می‌تواند اهداف مالی و امنیتی توسعه‌دهندگان و کاربران برنامک‌ها را ارضا کند. در سال‌های اخیر ارائه‌ی یک راهکار پرسرعت به همراه دقت مناسب، همواره یکی از دغدغه‌های مهم پژوهش‌کنندگان در این زمینه‌ بوده‌است.
 \\
 همانطور که گفته‌شد، بازبسته‌بندی برنامک‌های اندرویدی از دو دیدگاه تهاجمی و تدافعی قابل بررسی است. در حالتی که کاربر متقلب، برنامک اندرویدی اصلی را دجار تغییراتی می‌کند و آن را در اختیار عموم قرار می‌دهد،  تشخیص بازبسته‌بندی، با استفاده از مقایسه‌ی برنامک اصلی و برنامک جعلی صورت می‌گیرد. تشخیص بازبسته‌بندی در این حالت را می‌تواند در حالت کلی به دو طبقه تقسیم کرد. در حالت اول توسعه‌دهنده روش خود را مبتنی بر تحلیل برنامک مبدا و مقصد پیاده‌سازی می‌کند. عمده‌ی روش‌های موجود در این طبقه مبتنی بر تحلیل ایستا‌ی جفت‌ برنامک‌ها است و استفاده از تحلیل پویا به جهت سرعت پایین آن، محبوبیت فراوانی ندارد و بیشتر از تحلیل ایستای برنامک‌های اندرویدی استفاده می‌شود\مرجع{MANIRIHO20221}. در سمت دیگر طبقه‌بندی برنامک‌های اندرویدی وجود دارد.روش‌های موجود در این دسته، عمدتا سرعت بالایی دارند اما در تشخیص جفت بازبسته‌بندی شده دقت پایینی را ارائه می‌دهند.
\\
برنامک‌های اندرویدی متشکل از دو قسمت اصلی کد‌های برنامک و منابع آن هستند. کد‌های برنامک، منطق برنامک را تشکیل می‌دهند و رفتار برنامک با توجه به این قسمت مشخص  می‌شود. از طرفی منابع برنامک، ظاهر آن را تشکیل می‌دهند. روش‌های مبتنی بر تحلیل برنامک و یا طبقه‌بندی آن، عمدتاً از ویژگی‌های موجود در منابع و یا کد استفاده می‌کنند. مهاجم در حالاتی که می‌خواهد از محبوبیت برنامک مبدا استفاده کند، سعی در یکسان‌سازی ظاهر برنامک‌های مبدا و مقصد دارد به همین جهت از منابع برنامک مبدا استفاده می‌کند و منطق برنامک را مطابق با اهداف خود تغییر می‌دهد. در حالتی دیگر، متقلب سعی می‌کند که با استفاده از تغییر منابع برنامک و تولید یک برنامک تقلبی و گاهاً بدون هیچ تغییری در کد برنامک، ادعای توسعه‌ی یک برنامک جدید را اثبات کند. لازم به ذکر است استفاده از ویژگی‌های کد‌پایه و منبع‌پایه، به وفور در پژوهش‌های سال‌های اخیر یافت می‌شود که هر کدام معایب و مزایای خود را دارد.\\
در روش‌های مبتنی بر طبقه‌بندی عمدتا تعریف تشخیص بازبسته‌بندی محدود به تشخیص دسته‌ی مشکوک و یا دسته‌ای از برنامک‌ها است که احتمال بازبسته‌بندی بودن جفت‌های داخل این دسته‌، بیش از سایر دسته‌ها است. بنابراین تشخیص بازبسته‌بندی در این روش‌ها، محدود به تشخیص طبقه‌ی برنامک‌ ورودی می‌باشد و جفت بازبسته‌بندی شده مشخص نمی‌شود. از طرفی در روش‌های مبتنی بر تحلیل ایستا، بررسی دوبه‌دوی برنامک‌های ورودی و مجموعه‌داده مدنظر است. در این روش‌ها تعریف تشخیص بازبسته‌بندی گسترش یافته و یافتن جفت بازبسته‌بندی به صورت مشخیص، هدف پژوهش می‌شود. 
تغییر منابع برنامک‌ و همچنین مبهم‌نگاری در برنامک بازبسته‌بندی شده، دوجالش مهم در راستای تشخیص بازبسته‌بندی است. متقلب پس از بازبسته‌بندی برنامک، با استفاده از مبهم نگاری سعی می‌کند تغیرات خود و شباهت ساختار منطقی برنامک تقلبی با برنامک اصلی را پنهان کند. به همین جهت، تشخیص بازبسته‌بندی نیازمند ویژگی‌هایی است که مقاومت بالایی مقابل مبهم‌نگاری داشته‌باشد بدین معنا که تغییر و ایجاد ابهام در کد، به راحتی در این ویژگی‌ها قابل انجام نباشد. 
\\
در هنگار کامپایل برنامک‌های اندرویدی، کتابخانه‌هایی که در برنامک مورد استفاده قرار گرفته‌اند به همراه کد مورد توسعه، کامپایل شده و دالویک‌ بایت‌کد‌های آن در کنار برنامک قرار می‌گیرد. بر اساس پژوهش آقای زیانگ و همکاران \مرجع{libradar} 
$57\%$
از کد‌های برنامک‌های مورد بررسی در این پژوهش، شامل کد‌های کتابخانه‌ای بودند که دجار مبهم‌نگاری نشده‌اند. بنابراین تشخیص کد‌های بازبسته‌بندی شده بدون تشخیص درست و دقیق و جداسازی کد‌های کتابخانه‌ای امکان‌پذیر نیست و می‌تواند نتایج منفی غلط و مثبت غلط را کاهش دهد. به صورت کلی دو روش برای تشخیص کد‌های کتابخانه‌ای استفاده می‌شود، روش‌ مبتنی بر لیست سفید و یا روش تشخیص مبتنی بر شباهت سنجی. در روش لیست سفید، لیسیتی از مشهور ترین کتابخانه‌های موجود در مخازن کتابخانه‌های اندرویدی نظیر ماون را جمع آوری می‌شود و با استفاده از نام‌ کلاس‌ها و بسته‌های موجود کلاس‌های کتابخانه ای تشخیص‌داده می‌شود. مشخص است که این روش مقاومت بسیار کمی مقابل ساده‌ترین روش‌های مبهم‌نگاری در کتابخانه‌های اندرویدی دارد. در حالت دیگر از روش‌های مبتنی بر شباهت سنجی برای تشخیص کد‌های کتابخانه‌ای استفاده می‌شود که در این روش، تحلیل ایستا روی کد‌های برنامک‌ مبدا و مخزن کتابخانه‌های اندرویدی صورت می‌گیرد و در نهایت با یکدیگر مقایسه می‌شوند. مشخص است که روش‌های مبتنی بر شباهت‌سنجی از دقت بیشتری برخوردار هستند و تمایز بهتری میان کد‌های کتابخانه‌ای و کد‌های اصلی قرار می‌دهند اما اینگونه روش‌ها سرعت پایینی دارند. 
\\
پژوهش‌های ارائه‌شده در زمینه‌ی تشخیص برنامک‌های بازبسته‌بندی شده در سال‌های اخیر، عمدتاً در تلاش برای بهبود دقت و سرعت روش‌های پیشین بوده‌اند.مبهم‌نگاری باعث می‌شود که دقت روش‌های تشخیص مبتنی بر تحلیل ایستا و شباهت سنجی پایین بیاید و استفاده از ویژگی‌هایی را که مقاومت بالایی مقابل مبهم‌نگاری داشته باشند را واجب کند. از طرفی استفاده از ویزگی‌های مقاوم به مبهم‌نگاری، می‌تواند سرعت تشخیص را بسیار پایین آورده تا حدی که عملا استفاده از این روش‌ها در یک محیط صنعتی را غیر ممکن سازد. در این پژوهش ما با استفاده از ترکیب روش‌های تحلیل ایستا و طبقه‌بندی منابع، به همراه شباهت‌سنجی، روشی را ارائه‌ کرده‌ایم که در حالی که مقاومت بالایی نسبت به مبهم‌نگاری داشته‌باشد، سرعت روش‌های پیشین را نیز افزایش دهد. در این پژوهش به عنوان پیش‌پردازش، از یک طبقه‌بند نزدیک‌ترین همسایه برای کاهش فضای مقایسه‌ی دودویی و با استفاده از ویژگی‌های مبتنی بر منبع، استفاده شده‌است. با کاهش فضای مقایسه‌ی دودویی و طبقه‌بندی برنامک‌های مشکوک در یک دسته، مقایسه‌ی برنامک‌های موجود در آن دسته آغاز می‌شود. مقایسه‌ی دودویی در هر دسته مبتنی بر تحلیل ایستا و شباهت‌سنجی کد‌های برنامک انجام می‌شود. ابتدا ویژگی‌هایی از هر کلاس و متد در بسته‌های برنامک استخراج شده و امضای هر کلاس ساخته می‌شود به طوری که امضای هر کلاس منحصر به فرد و تا حد امکان مختص همان کلاس باشد. نوآوری روش مطروحه، ترکیب روش‌های مبتنی بر طبقه‌بندی و روش‌های مبتنی بر تحلیل می‌باشد که در نهایت منجر به افزایش سرعت و در عین حال دقت خوب در تشخیص برنامک‌های بازبسته‌بندی شده‌است. حذف کد‌های کتابخانه‌ای با استفاده از روشی مبتنی بر مقایسه‌ی کد‌های موجود در مخزن کتابخانه‌ها و کلاس‌های برنامک انجام می‌شود. مخزن کتابخانه‌ها متشکل از ۴۵۳ کتابخانه‌ی اندرویدی جمع‌آوری شده‌ از مخزن ماون مب‌باشد.  در نهایت پس از تشخیص کلاس‌های کتابخانه‌های اندرویدی و حذف آن‌ها از کد برنامک، کد‌های مورد توسعه به عنوان ورودی برای مقایسه‌ی دودویی مورد تحلیلی قرار می‌گیرند.\\
در ادامه‌ی این نگارش،  در فصل
\ref{premliminaries}
به بررسی و تعریف مفاهیم اولیه‌ی مورد نیاز در این پژوهش می‌پردازیم. در فصل 
\ref{literature}
به تعریف مسئله می‌پردازیم و همچنین مروری از کار‌های پیشین را خواهیم داشت. 
در ادامه و در فصل 
\ref{ourwork}
 روش مورد استفاده در این پژوهش، شرح داده خواهد‌شد  و در فصل 
\ref{result}
مقایسه و ارزیابی روش پیشنهادی خود‌ را ارائه می‌دهیم. در نهایت و در فصل 
\ref{conclusion}
ضمن جمع‌بندی این گزارش علمی، به بررسی نقاط ضعف و قوت این پژوهش و همچنین ارائه‌ی پیشنهاداتی جهت بهبود این پژوهش می‌پردازیم.
 
 
 
 
 
 
 
 
 